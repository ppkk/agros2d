<?xml version="1.0"?>
<coupling:coupling xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="XMLCoupling ../xsd/coupling_xml.xsd"
    xmlns:coupling="XMLCoupling">

    <coupling:general id="magnetic-heat" name="Joule losses">
        <coupling:description>Heat generated by Joule losses in magnetic field</coupling:description>
        <coupling:modules>
            <coupling:source id="magnetic" />
            <coupling:target id="heat" />
        </coupling:modules>
    </coupling:general>

    <coupling:constants>
        <coupling:constant id="MU0" value="1.2566371e-06" />
    </coupling:constants>

    <coupling:volume>
        <coupling:vector_form id="harmonic_weak" i="1" j="1" planar="0.5 * ma_gamma * (2 * PI * f)^2 * ((source1 + source3)^2 + (source2 + source4)^2) * vval" axi="0.5 * ma_gamma * (2 * PI * f)^2 * ((source1 + source3)^2 + (source2 + source4)^2) * r * vval" />

        <!-- TODO: has to be altered to new harmonic module with 4 fields. i: 3->5 and there will be probably two forms instead of one (i=5, j=1) AND (i=5, j=3)-->
        <coupling:matrix_form id="harmonic_hard_matrix_newton_3_1" i="3" j="1" planar="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * 2 * upval * uval * vval" axi="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * 2 * upval * uval * r * vval" />
        <coupling:matrix_form id="harmonic_hard_matrix_newton_3_2" i="3" j="2" planar="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * 2 * upval * uval * vval" axi="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * 2 * upval * uval * r * vval" />
        <coupling:vector_form id="harmonic_hard_vector_newton_3_1" i="3" j="1" planar="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * (upval * upval) * vval" axi="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * (upval * upval) * r * vval" />
        <coupling:vector_form id="harmonic_hard_vector_newton_3_2" i="3" j="2" planar="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * (upval * upval) * vval" axi="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * (upval * upval) * r * vval" />

       <!-- magnetic steady state-->
       <coupling:vector_form id="steady_weak" i="1" j="1" planar="ma_gamma * (((ma_vx - y * ma_va) * source1dx + (ma_vy + x * ma_va) * source1dy)^2) * vval" axi="0" />

        <coupling:weakforms_volume>
            <coupling:weakform_volume couplingtype="weak" sourceanalysis="harmonic" targetanalysis="steadystate" equation="">
                <coupling:linearity_option type="linear">
                    <coupling:vector_form id="harmonic_weak" />
                </coupling:linearity_option>

                <coupling:linearity_option type="newton">
                    <coupling:vector_form id="harmonic_weak" coefficient="-1"/>
                </coupling:linearity_option>

            </coupling:weakform_volume>

            <coupling:weakform_volume couplingtype="hard" sourceanalysis="harmonic" targetanalysis="steadystate" equation="">
                <coupling:linearity_option type="newton">
                    <coupling:matrix_form id="harmonic_hard_matrix_newton_3_1"/>
                    <coupling:matrix_form id="harmonic_hard_matrix_newton_3_2"/>
                    <coupling:vector_form id="harmonic_hard_vector_newton_3_1"/>
                    <coupling:vector_form id="harmonic_hard_vector_newton_3_2"/>
                </coupling:linearity_option>

            </coupling:weakform_volume>

            <coupling:weakform_volume couplingtype="weak" sourceanalysis="harmonic" targetanalysis="transient" equation="">
                <coupling:linearity_option type="linear">
                    <coupling:vector_form id="harmonic_weak" />
                </coupling:linearity_option>

                <coupling:linearity_option type="newton">
                    <coupling:vector_form id="harmonic_weak" coefficient="-1"/>
                </coupling:linearity_option>

            </coupling:weakform_volume>

            <coupling:weakform_volume couplingtype="hard" sourceanalysis="harmonic" targetanalysis="transient" equation="">
                <coupling:linearity_option type="newton">
                    <coupling:matrix_form id="harmonic_hard_matrix_newton_3_1"/>
                    <coupling:matrix_form id="harmonic_hard_matrix_newton_3_2"/>
                    <coupling:vector_form id="harmonic_hard_vector_newton_3_1"/>
                    <coupling:vector_form id="harmonic_hard_vector_newton_3_2"/>
                </coupling:linearity_option>

            </coupling:weakform_volume>

            <coupling:weakform_volume couplingtype="weak" sourceanalysis="steadystate" targetanalysis="steadystate" equation="">
                <coupling:linearity_option type="linear">
                    <coupling:vector_form id="steady_weak" />
                </coupling:linearity_option>

                <coupling:linearity_option type="newton">
                    <coupling:vector_form id="steady_weak" coefficient="-1"/>
                </coupling:linearity_option>

            </coupling:weakform_volume>

            <coupling:weakform_volume couplingtype="weak" sourceanalysis="steadystate" targetanalysis="transient" equation="">
                <coupling:linearity_option type="linear">
                    <coupling:vector_form id="steady_weak" />
                </coupling:linearity_option>

                <coupling:linearity_option type="newton">
                    <coupling:vector_form id="steady_weak" coefficient="-1"/>
                </coupling:linearity_option>

            </coupling:weakform_volume>

        </coupling:weakforms_volume>
    </coupling:volume>
</coupling:coupling>
